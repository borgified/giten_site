packages:
  yum:
    git: []

commands:
  10_make_letsencrypt_folder:
    command: "if [ ! -d /opt/letsencrypt ]; then mkdir /opt/letsencrypt; fi"
    leader_only: true
  20_make_directory_writeable:
    command: "chmod 664 /opt/letsencrypt"
    leader_only: true
  30_store_project_dir:
    command: "pwd > /opt/letsencrypt/prj_dir"
    leader_only: true
  40_copy_renewal_script:
    command: "cp letsencrypt/renew_cert.sh /opt/letsencrypt/"
    leader_only: true
  50_make_it_executable:
    command: "chmod +x /opt/letsencrypt/renew_cert.sh"
    leader_only: true
  60_create_cronjob:
    command: "echo \"15 * * * * /opt/letsencrypt/renew_cert.sh > /var/log/letsencrypt_renewal.log 2>&1\" > /etc/cron.d/renew_letsencrypt"
    leader_only: true
  70_change_perms:
    command: "chmod 644 /etc/cron.d/renew_letsencrypt"
    leader_only: true
